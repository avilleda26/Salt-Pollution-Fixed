testing
Eleanor was here.

ghghg
push attempt 

#Open Data
library(readxl)
df <- read_excel("~/Downloads/Consulting370.xlsx") 
str(salt.pollution)
head(salt.pollution)

#plots biomass by tank over years
library(ggplot2)
library(dplyr)

salt.pollution <- salt.pollution
ggplot(salt.pollution,aes(x = tankID, y = typhaBiomass_g, color = year)) + geom_point(alpha = 0.7, size = 2) + labs(title = "Typha Biomass by Tank ID (Colored by Year)",x = "Tank ID",y = "Typha biomass (g/m²)",color = "Year") + theme_minimal() + theme(axis.text.x = element_text(angle = 45, hjust = 1))

#Hypothesis test on tank size significance
salt.pollution <- salt.pollution
tanksize_anova <- aov(typhaBiomass_g ~ tankSize, data = salt.pollution)
summary(tanksize_anova)

TukeyHSD(tanksize_anova)

ggplot(salt.pollution,aes(x = tankSize, y = typhaBiomass_g)) + geom_boxplot(alpha = 0.7) + labs(title = "Effect of Tank Size on Typha Biomass",x = "Tank size",y = "Typha biomass (g/m²)") + theme_minimal()

#Tank size is NOT significant

#Hypothesis test on biomass and salt
salt.pollution <- salt.pollution
saltrate_anova <- aov(typhaBiomass_g ~ saltRate_trt, data = salt.pollution)
summary(saltrate_anova)

TukeyHSD(saltrate_anova)

ggplot(salt.pollution,aes(x = saltRate_trt, y = typhaBiomass_g)) + geom_boxplot(alpha = 0.7) + labs(title = "Effect of Tank Size on Typha Biomass",x = "Tank size",y = "Typha biomass (g/m²)") + theme_minimal()

#Salt Rate is significant - shown by anova 

#Chart of biomass by salt rate by year
ggplot(salt.pollution, aes(x = saltRate_trt, y = typhaBiomass_g, group = year, color = year)) + stat_summary(fun = mean, geom = "line", linewidth = 1) +
stat_summary(fun = mean, geom = "point", size = 2) + labs(title = "Mean Typha Biomass by Salt Rate and Year", x = "Salt Rate Treatment", y = "Mean Typha Biomass (g/m²)", color = "Year") +
theme_minimal()

#filter out which tanks got the salt treatments, none, mix

#plot biomass by month date 
library(dplyr)
library(ggplot2)

sumdat <- df
group_by(year, month)
summarise(n = sum(!is.na(typhaBiomass_g) & !is.na(tankArea_m2) & tankArea_m2 > 0), mean_biomass_g_m2 = mean(typhaBiomass_g / tankArea_m2, na.rm = TRUE), se_biomass_g_m2   = sd(typhaBiomass_g / tankArea_m2,  na.rm = TRUE) / sqrt(n), .groups = "drop")

#Averaged
ggplot(sumdat, aes(x = factor(month, levels = sort(unique(month))), y = mean_biomass_g_m2)) + geom_col() + geom_errorbar(aes(ymin = mean_biomass_g_m2 - se_biomass_g_m2, ymax = mean_biomass_g_m2 + se_biomass_g_m2), width = 0.2) + facet_wrap(~ year) +
labs(x = "Month", y = "Mean Typha biomass (g/m^2) ± SE",title = "Typha biomass by month, separated by year (standardized by tank area)") +
theme_minimal()

ggplot(df, aes(x = factor(month, levels = sort(unique(month))),y = typhaBiomass_g / tankArea_m2)) + geom_jitter(width = 0.15, height = 0) + facet_wrap(~ year) +
labs(x = "Month", y = "Typha biomass (g/m^2)",title = "Raw Typha biomass by month, separated by year (standardized by tank area)") +
theme_minimal()




